devtools::document()
usethis::use_vignette("shape_prep")
devtools::install()
library(StreamVAST)
?StreamVAST::CheckNetwork
devtools::install()
system.file("extdata",package="StreamVAST")
system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST")
?system.file
Mill.surveys<-sf::st_read(system.file("extdata","Mill_Creek_surveys.shp",package="StreamVAST"))
Mill.surveys2<-subset(Mill.surveys,Year%in%2007:2016)
Mill.surveys2<-subset(Mill.surveys,Year%in%2012:2022)
Mill.surveys2<-subset(Mill.surveys,Year%in%2013:2022)
sf::st_write(Mill.surveys2,"Mill_Creek_surveys_example.shp")
Mill.surveys<-sf::st_read(system.file("extdata","Mill_Creek_redds.shp",package="StreamVAST"))
Mill.surveys
Mill.surveys2<-subset(Mill.surveys,Year%in%2013:2022)
sf::st_write(Mill.surveys2,"Mill_Creek_redds_example.shp")
devtools::install()
system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST")
library(StreamVAST)
system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST")
system.file("extdata",package="StreamVAST")
library(StreamVAST)
Mill.basin0<-st_read(dsn = system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST",mustWork = T))
system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST")
list.files(system.file("extdata",package = "StreamVAST"))
devtools::intstall()
devtools::install()
library(StreamVAST)
system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST")
list.files(system.file("extdata",package = "StreamVAST"))
sf::st_read(dsn = system.file("extdata","Mill_Creek_basin_raw.shp",package="StreamVAST"))
library(StreamVAST)
library(sf)
library(ggplot2)
library(sfnetworks)
Mill.basin0<-st_read(dsn = "Mill_Creek_basin_raw.shp")
Mill.redds.sf<-st_read(dsn="Mill_Creek_redds_example.shp")
Mill.redds<-data.frame(as.data.frame(Mill.redds.sf),lon=st_coordinates(Mill.redds.sf)[,1],lat=st_coordinates(Mill.redds.sf)[,2])
Mill.basin<-as_sfnetwork(Mill.basin0)
Mill.surveys<-st_read(dsn="Mill_Creek_surveys_example.shp")
Mill.root<-st_as_sf(data.frame(x=963147.4,y=322499),coords=1:2,crs=2286)
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=2,alpha=.5)+
geom_sf(data=Mill.root,col=4,size=4,shape=18)+
scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
Mill.basin2<-PruneNetwork(network = Mill.basin, root = Mill.root,match = Mill.redds)
Mill.basin2<-PruneNetwork(network = Mill.basin, root = Mill.root,match = Mill.redds.sf)
Mill.basin2<-PruneNetwork(network = Mill.basin, root = Mill.root,match = Mill.redds.sf)
Mill.basin0<-st_read(dsn = "Mill_Creek_basin_raw.shp")
Mill.redds.sf<-st_read(dsn="Mill_Creek_redds_example.shp")
Mill.redds.sf<-st_read(dsn="Mill_Creek_redds_example.shp")
Mill.redds<-data.frame(as.data.frame(Mill.redds.sf),lon=st_coordinates(Mill.redds.sf)[,1],lat=st_coordinates(Mill.redds.sf)[,2])
Mill.redds<-data.frame(as.data.frame(Mill.redds.sf),lon=st_coordinates(Mill.redds.sf)[,1],lat=st_coordinates(Mill.redds.sf)[,2])
Mill.basin<-as_sfnetwork(Mill.basin0)
Mill.surveys<-st_read(dsn="Mill_Creek_surveys_example.shp")
Mill.root<-st_as_sf(data.frame(x=963147.4,y=322499),coords=1:2,crs=2286)
Mill.basin2<-PruneNetwork(network = Mill.basin, root = Mill.root,match = Mill.redds.sf)
Mill.root<-FindRoots(shape=Mill.basin0,mainstem = "Mill Creek")
library(StreamVAST)
library(StreamVAST)
library(sf)
library(sf)
library(ggplot2)
library(sfnetworks)
Mill.root<-EditFeatures(Mill.basin)
Mill.basin0<-st_read(dsn = "Mill_Creek_basin_raw.shp")
Mill.root<-EditFeatures(Mill.basin0)
LocateRoot(Mill.basin0)
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=2,alpha=.5)+
ggtitle("Mill Creek Basin")+
scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
Mill.basin0<-st_read(dsn = "Mill_Creek_basin_raw.shp")
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+ggtitle("Mill Creek Basin")+scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
Mill.root<-LocateRoot(Mill.basin0)
Mill.root
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+ggtitle("Mill Creek Basin")+geom_sf(data=Mill.root,col=2,shape=18)+scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+ggtitle("Mill Creek Basin")+geom_sf(data=Mill.root,col=2,shape=18,size=3)+scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
Mill.net<-Makesfnetwork(Mill.basin0)
Mill.net
head(Mill.basin0)
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+ggtitle("Mill Creek Basin")+scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
head(Mill.basin0)
Mill.basin0
Mill.net
Mill.net<-Makesfnetwork(Mill.basin0)
Mill.root<-LocateRoot(Mill.net)
ggplot()+geom_sf(data=Mill.basin0)+theme_bw()+ggtitle("Mill Creek Basin")+geom_sf(data=Mill.root,col=2,shape=18,size=3)+scale_x_continuous(breaks=c(-123.28,-123.24,-123.20),limits = st_bbox(Mill.basin0)[c(1,3)])
RootNetwork(Mill.net,Mill.root)
FixLoops(Mill.net,root=Mill.root)
st_as_sf(activate(Mill.net,"edges"))
Mill.net.edges<-st_as_sf(activate(Mill.net,"edges"))
i=1
seg<-Mill.net.edges[i,]
others<-Mill.net.edges[-i,]
loops<-NULL
for(i in 1:nrow(Mill.net.edges)){
seg<-Mill.net.edges[i,]
others<-Mill.net.edges[-i,]
picks<-which(seg$from==others$from & seg$to==others$to)
if(length(picks>0)){loops<-c(loops,i)}
}
loops
plot(Mill.net.edges$geometry)
plot(Mill.net.edges$geometry[loops],add=T,col=2)
Mill.net.edges$loop<-F
Mill.net.edges$loop[loops]<-T
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=0,1)
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(0,1))
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
ylim(c(46.18,46.22))+xlim(-123.22,-123.16)
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
ylim(c(46.18,46.22))
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))
Mill.net.edges
st_as_sf(data.frame(x=c(-123.22,-123.16),y=c(46.18,46.22)),coords=1:2,crs="wgs84")
st_transform(st_as_sf(data.frame(x=c(-123.22,-123.16),y=c(46.18,46.22)),coords=1:2,crs="wgs84"),crs = 2286)
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
ylim(c(320626,334686))+xlim(951567,967249)
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
ylim(c(320626,334686))+xlim(951567,962249)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
ylim(c(320626,334686))+xlim(951567,964249)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
ylim(c(321626,334686))+xlim(951567,964249)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2))+
geom_sf(data=Mill.root,col=2,shape=18,size=3)+
ylim(c(321626,334686))+xlim(951567,964249)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2),guide=F)+
geom_sf(data=Mill.root,col=2,shape=18,size=3)+
ylim(c(321626,334686))+xlim(951567,964249)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges,aes(col=loop))+scale_color_manual(values=c(1,2),guide="none")+
geom_sf(data=Mill.root,col=2,shape=18,size=3)+
ylim(c(321626,334686))+xlim(951567,964249)+theme_bw()
st_length(Mill.net.edges)[loops]
loops
Mill.net.edges2<-Mill.net.edges[-108,]
Mill.net.edges[loops,]
View(Mill.net.edges)
?as_sfnetwork
library(StreamVAST)
library(sf)
library(ggplot2)
library(sfnetworks)
Mill.basin<-as_sfnetwork(Mill.net.edges2)
print(Mill.basin2)
print(Mill.basin)
print(Mill.basin,10)
print(Mill.basin,3)
print(Mill.basin,0)
?print
Mill.basin2<-PruneNetwork(network = Mill.basin, root = Mill.root,match = Mill.redds.sf)
Mill.redds.sf<-st_read(dsn="Mill_Creek_redds_example.shp")
Mill.basin2<-PruneNetwork(network = Mill.basin, root = Mill.root,match = Mill.redds.sf)
Mill.basin2.edges<-st_as_sf(activate(Mill.basin2))
Mill.basin2.edges<-st_as_sf(activate(Mill.basin2,"edges"))
ggplot()+
geom_sf(Mill.net.edges2)+
geom_sf(Mill.basin2.edges,col=2)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()+
scale_x_continuous(breaks = c(-123.30,-123.26,-123.22,-123.18))
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=4,size=1)+
scale_x_continuous(breaks = c(-123.30,-123.26,-123.22,-123.18))
st_bbox(Mill.net.edges)
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=4,size=1)+
scale_x_continuous(breaks = c(-123.30,-123.26,-123.22,-123.18),limits = st_bbox(Mill.net.edges)[c(1,3)])
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=4,shape=1)+
scale_x_continuous(breaks = c(-123.30,-123.26,-123.22,-123.18),limits = st_bbox(Mill.net.edges)[c(1,3)])
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=4,shape=1,alpha=.2)+
scale_x_continuous(breaks = c(-123.30,-123.26,-123.22,-123.18),limits = st_bbox(Mill.net.edges)[c(1,3)])
ggplot()+
geom_sf(data=Mill.net.edges2)+
geom_sf(data=Mill.basin2.edges,col=2)+theme_bw()+
geom_sf(data=Mill.redds.sf,col=4,shape=1)+
scale_x_continuous(breaks = c(-123.30,-123.26,-123.22,-123.18),limits = st_bbox(Mill.net.edges)[c(1,3)])
library(StreamVAST)
library(sf)
library(ggplot2)
library(sfnetworks)
devtools::check()
devtools::check()
?locator
?read.csv
?aggregate
?quantile
?na.omit
devtools::check()
devtools::check()
devtools::check()
?devtools::install_github
devtools::install_github("https://github.com/Jpharris7/StreamVAST.git")
devtools::install_github("Jpharris7/StreamVAST.git")
